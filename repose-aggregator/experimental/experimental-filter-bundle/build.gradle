apply from: "$rootDir/gradle/baseProject.gradle"

apply plugin: 'ear'
apply plugin: 'maven'
apply plugin: 'maven-publish'
apply plugin: 'maven-publish-auth'

configurations {
    earFile
}

artifacts {
    earFile ear
}

//All the projects this guy depends on. We don't put them in dependencies, because we have to hit them up twice.
def deps = [
        ':repose-aggregator:experimental:exception-filter',
        ':repose-aggregator:experimental:experimental-filter-bundle',
        ':repose-aggregator:experimental:servlet-contract-filter',
        ':repose-aggregator:experimental:tightly-coupled-filter'
]

dependencies {
    deps.each { proj ->
        deploy project(proj)
        earlib project(path: proj, configuration: 'compile')
    }
}

publishing {
    publications {
        maven(MavenPublication) {
            artifact ear
        }
    }
    repositories {
        maven {
            name "releases.maven.research.rackspace.com"
            url "http://maven.research.rackspacecloud.com/content/repositories/releases"
        }
    }
}
